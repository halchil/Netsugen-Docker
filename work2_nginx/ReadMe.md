# マニフェストファイルを利用したコンテナの起動方法

## 前提知識
dockerプラットフォーム内のvolume,networkについて

コンテナを構成するもの ベース・イメージ・ネットワーク系の解説

## マニフェストファイルとは？

マニフェストファイルとは、コンテナの構成やをコードとして定義するファイルのこと。
これにより、コンテナをどのようにビルド・実行・連携させるかを記述し、
手動で長いコマンドを打たずに、再現性のある環境構築が可能となる。

簡単に言えば 「マニフェストファイル = コンテナ環境の設計図」である。

まずは、マニフェストファイルの内容を参照してみよう。
[docker-compose.yaml](./docker-compose.yaml)

## マニフェストファイルの構成

マニフェストファイルは、yaml形式でインデントにより階層分けされた項目について設定を行う。

### トップレベルキーの解説

Composeファイルの文法を指定し、どんなコンテナを動かすか決め、サービス同士の土台を作る。

- version =「使用するComposeファイルの文法バージョンを指定する」	

- services = 「どんなアプリ（コンテナ）を動かすか決める」

- volumes / networks =「サービスどうしの共通の土台をつくる」



## マニフェストファイルを利用したコンテナの起動

```
[実行コマンド]
docker compose -f docker-compose.yaml up -d

[結果]

```
コンテナの起動を確認する。

```
[実行コマンド]
docker ps

[結果]

```

次に、実際にページにアクセスして、正しくルーティングされていることを確認する。

```
[アクセスURL]
http://[AWS-URL] → index.htmlが表示
http://[AWS-URL]/test → nginx.confのルーティング表示
http://[AWS-URL]/secret → 403 deny
```

コンテナを停止する。
```
docker compose -f docker-compose.yaml down
```

# 応用問題

Nginxのルーティング設定は[nginx.conf](./nginx/nginx.conf)を参照。

こちらで通信経路をカスタマイズ可能となっている。